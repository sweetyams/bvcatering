!function(t){"function"==typeof define&&define.amd?define(["picker","jquery"],t):"object"==typeof exports?module.exports=t(require("./picker.js"),require("jquery")):t(Picker,jQuery)}(function(t,$){function e(t,e){var i=this,r=t.$node[0].value,n=t.$node.data("value"),a=n||r,s=n?e.formatSubmit:e.format;i.settings=e,i.$node=t.$node,i.queue={interval:"i",min:"measure create",max:"measure create",now:"now create",select:"parse create validate",highlight:"parse create validate",view:"parse create validate",disable:"deactivate",enable:"activate"},i.item={},i.item.clear=null,i.item.interval=e.interval||30,i.item.disable=(e.disable||[]).slice(0),i.item.enable=-function(t){return t[0]===!0?t.shift():-1}(i.item.disable),i.set("min",e.min).set("max",e.max).set("now"),a?i.set("select",a,{format:s,fromValue:!!r}):i.set("select",null).set("highlight",i.item.now),i.key={40:1,38:-1,39:1,37:-1,go:function(t){i.set("highlight",i.item.highlight.pick+t*i.item.interval,{interval:t*i.item.interval}),this.render()}},t.on("render",function(){var i=t.$root.children(),r=i.find("."+e.klass.viewset),n=function(t){return["webkit","moz","ms","o",""].map(function(e){return(e?"-"+e+"-":"")+t})},a=function(t,e){n("transform").map(function(i){t.css(i,e)}),n("transition").map(function(i){t.css(i,e)})};r.length&&(a(i,"none"),i[0].scrollTop=~~r.position().top-2*r[0].clientHeight,a(i,""))},1).on("open",function(){t.$root.find("button").attr("disabled",!1)},1).on("close",function(){t.$root.find("button").attr("disabled",!0)},1)}var i=24,r=60,n=12,a=i*r,s=t._;e.prototype.set=function(t,e,i){var r=this,n=r.item;return null===e?("clear"==t&&(t="select"),n[t]=e,r):(n["enable"==t?"disable":"flip"==t?"enable":t]=r.queue[t].split(" ").map(function(n){return e=r[n](t,e,i)}).pop(),"select"==t?r.set("highlight",n.select,i):"highlight"==t?r.set("view",n.highlight,i):"interval"==t?r.set("min",n.min,i).set("max",n.max,i):t.match(/^(flip|min|max|disable|enable)$/)&&("min"==t&&r.set("max",n.max,i),n.select&&r.disabled(n.select)&&r.set("select",n.select,i),n.highlight&&r.disabled(n.highlight)&&r.set("highlight",n.highlight,i)),r)},e.prototype.get=function(t){return this.item[t]},e.prototype.create=function(t,e,n){var o=this;return e=void 0===e?t:e,s.isDate(e)&&(e=[e.getHours(),e.getMinutes()]),$.isPlainObject(e)&&s.isInteger(e.pick)?e=e.pick:$.isArray(e)?e=+e[0]*r+ +e[1]:s.isInteger(e)||(e=o.now(t,e,n)),"max"==t&&e<o.item.min.pick&&(e+=a),"min"!=t&&"max"!=t&&(e-o.item.min.pick)%o.item.interval!==0&&(e+=o.item.interval),e=o.normalize(t,e,n),{hour:~~(i+e/r)%i,mins:(r+e%r)%r,time:(a+e)%a,pick:e}},e.prototype.createRange=function(t,e){var i=this,r=function(t){return t===!0||$.isArray(t)||s.isDate(t)?i.create(t):t};return s.isInteger(t)||(t=r(t)),s.isInteger(e)||(e=r(e)),s.isInteger(t)&&$.isPlainObject(e)?t=[e.hour,e.mins+t*i.settings.interval]:s.isInteger(e)&&$.isPlainObject(t)&&(e=[t.hour,t.mins+e*i.settings.interval]),{from:r(t),to:r(e)}},e.prototype.withinRange=function(t,e){return t=this.createRange(t.from,t.to),e.pick>=t.from.pick&&e.pick<=t.to.pick},e.prototype.overlapRanges=function(t,e){var i=this;return t=i.createRange(t.from,t.to),e=i.createRange(e.from,e.to),i.withinRange(t,e.from)||i.withinRange(t,e.to)||i.withinRange(e,t.from)||i.withinRange(e,t.to)},e.prototype.now=function(t,e){var i=this.item.interval,n=new Date,a=n.getHours()*r+n.getMinutes(),o=s.isInteger(e),l;return a-=a%i,l=0>e&&-i>=i*e+a,a+="min"==t&&l?0:i,o&&(a+=i*(l&&"max"!=t?e+1:e)),a},e.prototype.normalize=function(t,e){var i=this.item.interval,r=this.item.min&&this.item.min.pick||0;return e-="min"==t?0:(e-r)%i},e.prototype.measure=function(t,e,n){var a=this;return e||(e="min"==t?[0,0]:[i-1,r-1]),"string"==typeof e?e=a.parse(t,e):e===!0||s.isInteger(e)?e=a.now(t,e,n):$.isPlainObject(e)&&s.isInteger(e.pick)&&(e=a.normalize(t,e.pick,n)),e},e.prototype.validate=function(t,e,i){var r=this,n=i&&i.interval?i.interval:r.item.interval;return r.disabled(e)&&(e=r.shift(e,n)),e=r.scope(e),r.disabled(e)&&(e=r.shift(e,-1*n)),e},e.prototype.disabled=function(t){var e=this,i=e.item.disable.filter(function(i){return s.isInteger(i)?t.hour==i:$.isArray(i)||s.isDate(i)?t.pick==e.create(i).pick:$.isPlainObject(i)?e.withinRange(i,t):void 0});return i=i.length&&!i.filter(function(t){return $.isArray(t)&&"inverted"==t[2]||$.isPlainObject(t)&&t.inverted}).length,-1===e.item.enable?!i:i||t.pick<e.item.min.pick||t.pick>e.item.max.pick},e.prototype.shift=function(t,e){var i=this,r=i.item.min.pick,n=i.item.max.pick;for(e=e||i.item.interval;i.disabled(t)&&(t=i.create(t.pick+=e),!(t.pick<=r||t.pick>=n)););return t},e.prototype.scope=function(t){var e=this.item.min.pick,i=this.item.max.pick;return this.create(t.pick>i?i:t.pick<e?e:t)},e.prototype.parse=function(t,e,i){var n,a,o,l,c,m=this,u={};if(!e||"string"!=typeof e)return e;i&&i.format||(i=i||{},i.format=m.settings.format),m.formats.toArray(i.format).map(function(t){var i,r=m.formats[t],n=r?s.trigger(r,m,[e,u]):t.replace(/^!/,"").length;r&&(i=e.substr(0,n),u[t]=i.match(/^\d+$/)?+i:i),e=e.substr(n)});for(l in u)c=u[l],s.isInteger(c)?l.match(/^(h|hh)$/i)?(n=c,("h"==l||"hh"==l)&&(n%=12)):"i"==l&&(a=c):l.match(/^a$/i)&&c.match(/^p/i)&&("h"in u||"hh"in u)&&(o=!0);return(o?n+12:n)*r+a},e.prototype.formats={h:function(t,e){return t?s.digits(t):e.hour%n||n},hh:function(t,e){return t?2:s.lead(e.hour%n||n)},H:function(t,e){return t?s.digits(t):""+e.hour%24},HH:function(t,e){return t?s.digits(t):s.lead(e.hour%24)},i:function(t,e){return t?2:s.lead(e.mins)},a:function(t,e){return t?4:a/2>e.time%a?"a.m.":"p.m."},A:function(t,e){return t?2:a/2>e.time%a?"AM":"PM"},toArray:function(t){return t.split(/(h{1,2}|H{1,2}|i|a|A|!.)/g)},toString:function(t,e){var i=this;return i.formats.toArray(t).map(function(t){return s.trigger(i.formats[t],i,[0,e])||t.replace(/^!/,"")}).join("")}},e.prototype.isTimeExact=function(t,e){var i=this;return s.isInteger(t)&&s.isInteger(e)||"boolean"==typeof t&&"boolean"==typeof e?t===e:(s.isDate(t)||$.isArray(t))&&(s.isDate(e)||$.isArray(e))?i.create(t).pick===i.create(e).pick:$.isPlainObject(t)&&$.isPlainObject(e)?i.isTimeExact(t.from,e.from)&&i.isTimeExact(t.to,e.to):!1},e.prototype.isTimeOverlap=function(t,e){var i=this;return s.isInteger(t)&&(s.isDate(e)||$.isArray(e))?t===i.create(e).hour:s.isInteger(e)&&(s.isDate(t)||$.isArray(t))?e===i.create(t).hour:$.isPlainObject(t)&&$.isPlainObject(e)?i.overlapRanges(t,e):!1},e.prototype.flipEnable=function(t){var e=this.item;e.enable=t||(-1==e.enable?1:-1)},e.prototype.deactivate=function(t,e){var i=this,r=i.item.disable.slice(0);return"flip"==e?i.flipEnable():e===!1?(i.flipEnable(1),r=[]):e===!0?(i.flipEnable(-1),r=[]):e.map(function(t){for(var e,n=0;n<r.length;n+=1)if(i.isTimeExact(t,r[n])){e=!0;break}e||(s.isInteger(t)||s.isDate(t)||$.isArray(t)||$.isPlainObject(t)&&t.from&&t.to)&&r.push(t)}),r},e.prototype.activate=function(t,e){var i=this,r=i.item.disable,n=r.length;return"flip"==e?i.flipEnable():e===!0?(i.flipEnable(1),r=[]):e===!1?(i.flipEnable(-1),r=[]):e.map(function(t){var e,a,o,l;for(o=0;n>o;o+=1){if(a=r[o],i.isTimeExact(a,t)){e=r[o]=null,l=!0;break}if(i.isTimeOverlap(a,t)){$.isPlainObject(t)?(t.inverted=!0,e=t):$.isArray(t)?(e=t,e[2]||e.push("inverted")):s.isDate(t)&&(e=[t.getFullYear(),t.getMonth(),t.getDate(),"inverted"]);break}}if(e)for(o=0;n>o;o+=1)if(i.isTimeExact(r[o],t)){r[o]=null;break}if(l)for(o=0;n>o;o+=1)if(i.isTimeOverlap(r[o],t)){r[o]=null;break}e&&r.push(e)}),r.filter(function(t){return null!=t})},e.prototype.i=function(t,e){return s.isInteger(e)&&e>0?e:this.item.interval},e.prototype.nodes=function(t){var e=this,i=e.settings,r=e.item.select,n=e.item.highlight,a=e.item.view,o=e.item.disable;return s.node("ul",s.group({min:e.item.min.pick,max:e.item.max.pick,i:e.item.interval,node:"li",item:function(t){t=e.create(t);var l=t.pick,c=r&&r.pick==l,m=n&&n.pick==l,u=o&&e.disabled(t);return[s.trigger(e.formats.toString,e,[s.trigger(i.formatLabel,e,[t])||i.format,t]),function(t){return c&&t.push(i.klass.selected),m&&t.push(i.klass.highlighted),a&&a.pick==l&&t.push(i.klass.viewset),u&&t.push(i.klass.disabled),t.join(" ")}([i.klass.listItem]),"data-pick="+t.pick+" "+s.ariaAttr({role:"option",selected:c&&e.$node.val()===s.trigger(e.formats.toString,e,[i.format,t])?!0:null,activedescendant:m?!0:null,disabled:u?!0:null})]}})+s.node("li",s.node("button",i.clear,i.klass.buttonClear,"type=button data-clear=1"+(t?"":" disabled")+" "+s.ariaAttr({controls:e.$node[0].id})),"",s.ariaAttr({role:"presentation"})),i.klass.list,s.ariaAttr({role:"listbox",controls:e.$node[0].id}))},e.defaults=function(t){return{clear:"Clear",format:"h:i A",interval:30,klass:{picker:t+" "+t+"--time",holder:t+"__holder",list:t+"__list",listItem:t+"__list-item",disabled:t+"__list-item--disabled",selected:t+"__list-item--selected",highlighted:t+"__list-item--highlighted",viewset:t+"__list-item--viewset",now:t+"__list-item--now",buttonClear:t+"__button--clear"}}}(t.klasses().picker),t.extend("pickatime",e)});